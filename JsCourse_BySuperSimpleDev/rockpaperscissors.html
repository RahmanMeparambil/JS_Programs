<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock-Paper-Scissors</title>
    <style>

        .display{
            display: block;
            /* background-color: bisque; */
            margin-top:20px;
            padding:20px 20px 20px;
            /* border-style: solid; */
        }

    </style>
</head>
<body>
    <button class="b_rock">Rock</button>
    <button class="b_papper">Papper</button>
    <button class="b_scissors">Scissors</button>
    <br>
    <br>
    <br>
    <button class="reset">Reset</button>
    <button class="ap">AutoPlay</button>
    <div class="display"></div>

    <script>
        let intervalId ;
        let isAutoplay = false ;
        let score =JSON.parse(localStorage.getItem('score'))||{
            wins : 0,
            loss : 0,
            draw : 0
        }
        display()
        let b_rock = document.querySelector('.b_rock')
        let b_papper = document.querySelector('.b_papper')
        let b_scissors = document.querySelector('.b_scissors')
        let b_reset = document.querySelector('.reset')
        let b_display = document.querySelector('.display')
        let b_autoplay = document.querySelector('.ap')

        
        function computerMove(){
            let r = Math.random()
            if (r<=1/3){
                return 'rock'
            }
            else if(r<=2/3){
                return 'papper'
            }
            else{
                return 'scissors'
            }
        }
        function playGame(move){
            let cmove = computerMove()
            if (move === cmove){
                score.draw +=1
            }
            else if (move === 'rock'){
                if (cmove === 'papper'){
                    score.loss+=1
                }
                else{
                    score.wins+=1
                }
            }
            else if(move === 'papper'){
                if (cmove === 'rock'){
                    score.wins+=1
                }
                else {
                    score.loss +=1
                }
            }
            else{
                if (cmove=== 'rock'){
                    score.wins+=1
                }
                else{
                    score.loss+=1
                }
            }
            localStorage.setItem('score',JSON.stringify(score))
            display()
        }
        function reset(){
            score = {
            wins : 0,
            loss : 0,
            draw : 0
        }
        localStorage.setItem('score',JSON.stringify(score))
        display()
        }

        function display(){
            b_display.innerHTML = `<p>Wins :${score.wins} Loss :${score.loss} Draw:${score.draw}</p>`
        }

        function autoplay(){
            if (!isAutoplay){
                b_autoplay.innerHTML = 'stop'
                intervalId = setInterval(function (){playGame(computerMove())},1000)
                isAutoplay = true;
            }
            else{
                b_autoplay.innerHTML = 'AutoPlay'
                clearInterval(intervalId)
                isAutoplay = false;
            }

        }

        // Event handle
        b_rock.addEventListener('click',function b_rockHandler(){
            return playGame('rock')
        })
        b_papper.addEventListener('click',function b_papperHandler(){
            return playGame('papper')
        })
        b_scissors.addEventListener('click',function b_scissorsHandler(){
            return playGame('scissors')
        })
        b_reset.addEventListener('click',function b_resetHandler(){
            return reset()
        })
        b_autoplay.addEventListener('click',function b_autoplayHandler(){
            return autoplay()
        })
        
    </script>
</body>
</html>